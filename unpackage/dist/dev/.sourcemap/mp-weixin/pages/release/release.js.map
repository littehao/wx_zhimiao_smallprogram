{"version":3,"sources":["webpack:////Users/huhao/Desktop/www/wx_zhimiao/pages/release/release.vue?f9d6","webpack:////Users/huhao/Desktop/www/wx_zhimiao/pages/release/release.vue?990a","webpack:////Users/huhao/Desktop/www/wx_zhimiao/pages/release/release.vue?68f3","webpack:////Users/huhao/Desktop/www/wx_zhimiao/pages/release/release.vue?e52b","uni-app:///pages/release/release.vue"],"names":["data","showLogin","fontNum","TitlefontNum","serverUrl","wordkAddress","imageValue","enclosure","headers","bloblist","imageStyles","width","height","form","title","content","address","xaxis","yaxis","demandPrice","submit","computed","created","uni","console","that","token","onHide","methods","sendFn","requestPaymentFn","provider","timeStamp","nonceStr","package","signType","paySign","success","_this","fail","icon","registrationDemandFn","res","initFn","setTimeout","locationTo","url","navRule","sumfontnum","titlesumfontnum","select","e","imgupload","operationCode","then","removeImg","index","operationId"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoH;AACpH;AAC2D;AACL;;;AAGtD;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,kFAAM;AACR,EAAE,2FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,sFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,oPAEN;AACP,KAAK;AACL;AACA,aAAa,8OAEN;AACP,KAAK;AACL;AACA,aAAa,4WAEN;AACP,KAAK;AACL;AACA,aAAa,0MAEN;AACP,KAAK;AACL;AACA,aAAa,sKAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACrEA;AAAA;AAAA;AAAA;AAAq0B,CAAgB,qyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACgEz1B;AAAA;AAAA;AAAA,eACA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;QACAC;QACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QACAC;MACA;IACA;EACA;;EACAC,4BACA,2DACA;EACAC;IAAA;IACA;IACAC;MACAC;MACA;QACAC;QACAA;QACAA;MACA;IACA;IACA;MACA;MACA;QACAC;MACA;MACAF;IACA;EACA;EACAG;IACA;EAAA,CACA;EACAC,yCACA;IACAC;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACAP;QACAQ;QAAA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;UACAb;UACAA;UACAc;UACA;UACA;UACA;UACA;QACA;;QACAC;UACAf;UACAA;UACA;YACAD;cACAiB;cACA1B;YACA;YACAwB;UACA;YACAf;cACAiB;cACA1B;YACA;YACAwB;UACA;QACA;MACA;IACA;IACAG;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAzC,uCACA;kBACAO;gBAAA;gBAAA;gBAAA,OAEA;cAAA;gBAAAmC;gBACA;kBACA;gBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAlB;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAmB;MAAA;MACA;MACA;QACA7B;QACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACAwB;UACA;QACA;MACA;IACA;IACAC;MACAtB;QACAuB;MACA;IACA;IACAC;MACAxB;QACAuB;MACA;IACA;IACAE;MAAA;MACA;IACA;IACAC;MACA;IACA;IACAC;MAAA;MACA;MACA;QACAC;UACA;QACA;QACA;MACA;MACA;MACA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACA;kBACA;oBAAAC;kBAAA,GACAC;oBACA;oBACA;kBACA;gBACA;kBACA9B;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA+B;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAC;gBAAA;gBAAA,OACA;kBAAAH;kBAAAI;gBAAA;cAAA;gBAAAf;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EAAA;AAEA;AAAA,2B","file":"pages/release/release.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./release.vue?vue&type=template&id=0766b1d4&\"\nvar renderjs\nimport script from \"./release.vue?vue&type=script&lang=js&\"\nexport * from \"./release.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/release/release.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./release.vue?vue&type=template&id=0766b1d4&\"","var components\ntry {\n  components = {\n    comheader: function () {\n      return import(\n        /* webpackChunkName: \"components/comheader/comheader\" */ \"@/components/comheader/comheader.vue\"\n      )\n    },\n    tuiIcon: function () {\n      return import(\n        /* webpackChunkName: \"components/tui-icon/tui-icon\" */ \"@/components/tui-icon/tui-icon.vue\"\n      )\n    },\n    uniFilePicker: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker\" */ \"@/uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.vue\"\n      )\n    },\n    tuiNoData: function () {\n      return import(\n        /* webpackChunkName: \"components/tui-no-data/tui-no-data\" */ \"@/components/tui-no-data/tui-no-data.vue\"\n      )\n    },\n    login: function () {\n      return import(\n        /* webpackChunkName: \"components/login/login\" */ \"@/components/login/login.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.showLogin = true\n    }\n    _vm.e1 = function ($event) {\n      _vm.showLogin = false\n    }\n    _vm.e2 = function ($event) {\n      return _vm.$refs.paypopup.close()\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./release.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./release.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"release-page h-100vh\">\n\t\t<comheader :backBtn=\"false\" title=\"发布需求\"></comheader>\t\n\t\t<template v-if=\"getIsLogin\">\n\t\t\t<view class=\"release-form flex-1 mx-2 flex flex-column pt-2\">\n\t\t\t\t<view class=\"border-bottom flex align-center position-relative mb-2 bgffff px-2\" style=\"min-height: 48px;\">\n\t\t\t\t\t<textarea v-model=\"form.title\" placeholder=\"需求标题\" placeholder-class=\"placeholder\" maxlength=\"50\" name=\"title\" auto-height @input=\"titlesumfontnum\"/>\n\t\t\t\t\t<text class=\"position-absolute ftC9CDD4 fs-24\" style=\"bottom:5px;right:5px\">{{TitlefontNum}}/50</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"border-bottom flex flex-column mb-2 bgffff p-2\" style=\"min-height: 48px;\">\n\t\t\t\t\t<textarea v-model=\"form.content\" placeholder=\"需求描述\" placeholder-class=\"placeholder\" maxlength=\"100\" name=\"detail\" style=\"width:100%\" @input=\"sumfontnum\"/>\n\t\t\t\t\t<view class=\"flex align-center justify-end\">\n\t\t\t\t\t\t<text class=\"ftC9CDD4 fs-24\">{{fontNum}}/100</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"flex justify-start mb-4\">\n\t\t\t\t\t<view class=\"flex align-center bgF2F3F5 rounded-circle  px-2 py-1\" @click=\"locationTo\">\n\t\t\t\t\t\t<tui-icon color=\"#4E5969\" size=\"16\" name=\"gps\"></tui-icon>\n\t\t\t\t\t\t<text class=\"ml-1 fs-24 ft4E5969\">{{form.address || wordkAddress}}</text>\n\t\t\t\t\t</view>\t\n\t\t\t\t</view>\n\t\t\t\t<view class=\"border-bottom pb-2 bgffff px-2 py-3\">\n\t\t\t\t\t<view class=\"flex align-center mb-1 ft1D2129 fs-32\">上传图片<text class=\"ft86909C fs-28\">(最多上传4张)</text></view>\n\t\t\t\t\t<uni-file-picker ref=\"unifilepicker\" v-model=\"imageValue\" fileMediatype=\"image\" return-type=\"array\" mode=\"grid\"\n\t\t\t\t\t@select=\"select\" @delete=\"removeImg\" :auto-upload=\"false\" limit=\"4\" :image-styles=\"imageStyles\"/>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"flex align-center border-bottom bgffff px-2 py-2\" style=\"height: 46px;\">\n\t\t\t\t\t<text class=\"ft000000 fs-28 family\">需求价格</text>\n\t\t\t\t\t<input v-model=\"form.demandPrice\" class=\"flex-1 text-right py-1\" type=\"digit\" placeholder-class=\"placeholder\" placeholder=\"请输入价格\" />\n\t\t\t\t\t<text class=\"ftF85241 fs-28 family ml-2\">元</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"flex align-center ft86909C fs-24 py-2\">发布即代表同意 <text class=\"fs-24 ftF85241\" @click=\"navRule\">《寻工/找工信息发布规则》</text></view>\t\n\t\t\t</view>\n\t\t\t<view class=\"flex-1 flex align-end\">\n\t\t\t\t<view class=\"border-top  w-100 px-32 border-box pt-2\">\n\t\t\t\t\t<view class=\"ftffff fs-28 bgF85241 rounded-circle text-center py-2 w-100\" @tap=\"sendFn\">发布需求</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view :style=\"{height:(getSafeAreaBottom + 70)+'px'}\"></view>\n\t\t</template>\n\t\t<template v-else>\n\t\t\t<tui-no-data :imgUrl=\"`https://zm.zgzhm.com/mini/img/img_nodata.png`\" :marginBottom=\"0\" :imgWidth=\"300\" :imgHeight=\"300\" btnText=\"去登录\" backgroundColor=\"#F85241\" @click=\"showLogin = true\">\n\t\t\t\t<text class=\"fs-28\">登录后发布需求</text>\n\t\t\t</tui-no-data>\n\t\t</template>\n\t\t\n\t\t<login :modal=\"showLogin\" @hide=\"showLogin = false\"></login>\n\t\t<!--支付确认-->\n\t\t<uni-popup ref=\"paypopup\" type=\"center\" :mask-click=\"false\" style=\"z-index: 9999999;\">\n\t\t\t<view class=\"rounded-lg bgffff p-2\" style=\"width: 650rpx;height: 400rpx;\">\n\t\t\t\t<view class=\"fs-32 ft000000 text-center mb-4 font-weight-bolder\">请选择是否支付发布</view>\n\t\t\t\t<view class=\"bgF85241 ftffff fs-30 text-center rounded-circle py-2 border mb-2\" \n\t\t\t\tstyle=\"border-color: transparent;\" \n\t\t\t\t@click=\"registrationDemandFn(1)\">支付并发布</view>\n\t\t\t\t<view class=\"border rounded-circle text-center py-2 fs-30 ftF85241 mb-2\" \n\t\t\t\tstyle=\"border-color: #F85241;\" \n\t\t\t\t@click=\"registrationDemandFn(2)\">直接发布</view>\n\t\t\t\t<view class=\"border rounded-circle text-center py-2 fs-30\" @click=\"$refs.paypopup.close()\">取消发布</view>\n\t\t\t</view>\n\t\t</uni-popup>\n\t</view>\n</template>\n\n<script>\n\timport {mapGetters,mapActions} from 'vuex'\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tshowLogin:false,\n\t\t\t\tfontNum:0,\n\t\t\t\tTitlefontNum:0,\n\t\t\t\tserverUrl:'',\n\t\t\t\twordkAddress:'定位工作地点',\n\t\t\t\timageValue:[],\n\t\t\t\tenclosure:[],//上传图片id\n\t\t\t\theaders:{},//上传图片headers\n\t\t\t\tbloblist:[],\n\t\t\t\timageStyles:{\n\t\t\t\t\twidth:100,\n\t\t\t\t\theight:100\n\t\t\t\t},\n\t\t\t\tform:{\n\t\t\t\t\ttitle:'',\n\t\t\t\t\tcontent:'',\n\t\t\t\t\taddress:'',\n\t\t\t\t\txaxis:'',//经度\n\t\t\t\t\tyaxis:'',//纬度\n\t\t\t\t\tdemandPrice:'',\n\t\t\t\t\tsubmit:1,//1提交  0草稿\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomputed:{\n\t\t\t...mapGetters(['getSafeAreaBottom','getIsLogin'])\n\t\t},\n\t\tcreated() {\n\t\t\tlet that = this\n\t\t\tuni.$on('updateData',function(data){\n\t\t\t\tconsole.log(data)\n\t\t\t\tif(data.type == 'release'){\n\t\t\t\t\tthat.form.xaxis = data.location.lat\n\t\t\t\t\tthat.form.yaxis = data.location.lng\n\t\t\t\t\tthat.form.address  = data.title\n\t\t\t\t}\n\t\t\t})\n\t\t\tthis.uploadFileToDisk().then(url => {\n\t\t\t\tthis.serverUrl = url\n\t\t\t\tthis.headers  = {\n\t\t\t\t\ttoken:this.tui.getToken(),\n\t\t\t\t}\n\t\t\t\tconsole.log(this.serverUrl)\n\t\t\t})\n\t\t},\n\t\tonHide(){\n\t\t\t// uni.showTabBar()\n\t\t},\n\t\tmethods: {\n\t\t\t...mapActions(['registrationDemand','uploadFileToDisk','deleteFile']),\n\t\t\tsendFn(){\n\t\t\t\tif(!this.form.title){\n\t\t\t\t\tthis.tui.toast('请填写需求标题')\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(!this.form.content){\n\t\t\t\t\tthis.tui.toast('请填写需求内容')\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(!this.form.address){\n\t\t\t\t\tthis.tui.toast('请选择工作地址')\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// if(this.enclosure.length < 1){\n\t\t\t\t// \tthis.tui.toast('请上传需求图片附近')\n\t\t\t\t// \treturn;\n\t\t\t\t// }\n\t\t\t\tif(!this.form.demandPrice){\n\t\t\t\t\tthis.tui.toast('请填写需求价格')\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.$refs.paypopup.open()\n\t\t\t},\n\t\t\trequestPaymentFn(pay){\n\t\t\t\tconst _this = this\n\t\t\t\tuni.requestPayment({\n\t\t\t\t\tprovider: 'wxpay',    //支付类型-固定值\n\t\t\t\t\ttimeStamp: pay.timeStamp,\n\t\t\t\t\tnonceStr: pay.nonceStr,\n\t\t\t\t\tpackage: pay.packageValue,\n\t\t\t\t\tsignType: pay.signType,\n\t\t\t\t\tpaySign: pay.paySign,\n\t\t\t\t\tsuccess: function (res) {\n\t\t\t\t\t\tconsole.log('success:' + JSON.stringify(res));\n\t\t\t\t\t\tconsole.log(\"支付成功\");\n\t\t\t\t\t\t_this.initFn()\n\t\t\t\t\t\t// uni.showToast({\n\t\t\t\t\t\t// \ticon: 'success',\n\t\t\t\t\t\t// \ttitle: '支付成功'\n\t\t\t\t\t\t// })\n\t\t\t\t\t},\n\t\t\t\t\tfail: function (err) {\n\t\t\t\t\t\tconsole.log('fail:' + JSON.stringify(err));\n\t\t\t\t\t\tconsole.log(\"支付失败\");\n\t\t\t\t\t\tif(err.errMsg.includes('cancel')){\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\ttitle: '取消支付'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t_this.initFn('cancel')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\ttitle: '支付失败'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t_this.initFn('cancel')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tasync registrationDemandFn(type){ // 发布需求\n\t\t\t\ttry{\n\t\t\t\t\tlet data = {\n\t\t\t\t\t\t...this.form,\n\t\t\t\t\t\tenclosure:this.enclosure.join(',')\n\t\t\t\t\t}\n\t\t\t\t\tlet res = await this.registrationDemand(data)\n\t\t\t\t\tif(type == 1){\n\t\t\t\t\t\tthis.requestPaymentFn(res.data)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.initFn()\n\t\t\t\t\t}    \n\t\t\t\t}catch(e){\n\t\t\t\t\tconsole.log(e)\n\t\t\t\t\tthis.tui.toast(e.msg)\n\t\t\t\t\t//TODO handle the exception\n\t\t\t\t}\n\t\t\t},\n\t\t\tinitFn(type){\n\t\t\t\tthis.$refs.paypopup.close()\n\t\t\t\tthis.form = {\n\t\t\t\t\ttitle:'',\n\t\t\t\t\tcontent:'',\n\t\t\t\t\taddress:'',\n\t\t\t\t\txaxis:'',//经度\n\t\t\t\t\tyaxis:'',//纬度\n\t\t\t\t\tdemandPrice:'',\n\t\t\t\t\tsubmit:1,\n\t\t\t\t}\n\t\t\t\t// this.form = this.$options.data().form\n\t\t\t\tthis.enclosure  = []\n\t\t\t\tthis.imageValue = []\n\t\t\t\tthis.bloblist = []\n\t\t\t\tthis.$refs.unifilepicker.clearFiles()\n\t\t\t\tthis.$emit('follow')\n\t\t\t\tif(!type){\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.tui.toast('提交成功，审核中...')   \n\t\t\t\t\t},1000)\n\t\t\t\t}\n\t\t\t},\n\t\t\tlocationTo(){\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl:'/pagesA/location/location'\n\t\t\t\t})\n\t\t\t},\n\t\t\tnavRule(){\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl:'/pagesA/agreement/agreement?type=2'\n\t\t\t\t})\n\t\t\t},\n\t\t\tsumfontnum(e){ // 限制标题字数\n\t\t\t\tthis.fontNum=e.detail.value.length\n\t\t\t},\n\t\t\ttitlesumfontnum(e){\n\t\t\t\tthis.TitlefontNum=e.detail.value.length\n\t\t\t},\n\t\t\tselect(e) {\n\t\t\t\t//当选择多张一起上传\n\t\t\t\tif(e.tempFilePaths.length>1){\n\t\t\t\t\te.tempFiles.map((item,index)=>{\n\t\t\t\t\t\tthis.imgupload(e.tempFilePaths[index]);\n\t\t\t\t\t})\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//单张上传\n\t\t\t\tthis.imgupload(e.tempFilePaths[0]);\n\t\t\t},\n\t\t\t//上传图片\n\t\t\tasync imgupload(imgfile) {\n\t\t\t    try{\n\t\t\t\t\tthis.tui.uploadFile(this.serverUrl,imgfile,{operationCode:'demandRegistration'})\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tthis.enclosure.push(res.id)\n\t\t\t\t\t\tthis.bloblist.push(imgfile);\n\t\t\t\t\t})\n\t\t\t\t}catch(e){ \n\t\t\t\t\tconsole.log(e)\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync removeImg(e){ //删除图片，回传index\n\t\t\t\ttry{\n\t\t\t\t\tlet index = this.bloblist.indexOf(e.tempFilePath);\n\t\t\t\t\tlet res = await this.deleteFile({operationCode:'demandRegistration',operationId:this.enclosure[index]})\n\t\t\t\t\tthis.enclosure.splice(e.index,1)\n\t\t\t\t}catch(e){\n\t\t\t\t\tthis.tui.toast(e.data.msg)\n\t\t\t\t\t//TODO handle the exception\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n\n</style>\n"],"sourceRoot":""}